<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sorry Guy üíñ</title>

<style>
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
    font-family:'Segoe UI', sans-serif;
}

body{
    min-height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    background: linear-gradient(135deg,#ff758c,#ff7eb3,#a18cd1);
    background-size:400% 400%;
    animation: gradientMove 8s ease infinite;
    color:white;
    overflow-x:hidden;
    transition: background 0.5s;
}

@keyframes gradientMove{
    0%{background-position:0% 50%;}
    50%{background-position:100% 50%;}
    100%{background-position:0% 50%;}
}

.intro-page, .game-container{
    position:relative;
    width:90%;
    max-width:500px;
    background: rgba(255,255,255,0.15);
    backdrop-filter: blur(20px);
    border-radius:25px;
    padding:30px;
    text-align:center;
    box-shadow:0 25px 50px rgba(0,0,0,0.4);
    transition: opacity 0.5s, transform 0.5s;
}

.intro-page h1{
    font-size:28px;
    margin-bottom:15px;
}

.intro-page p{
    font-size:16px;
    margin-bottom:20px;
}

.intro-page input{
    padding:10px 15px;
    border-radius:10px;
    border:none;
    font-size:16px;
    margin-bottom:15px;
    width:80%;
}

.intro-page button{
    padding:15px 30px;
    border:none;
    border-radius:15px;
    font-size:18px;
    cursor:pointer;
    font-weight:600;
    background:#ffd369;
    color:#333;
    transition:0.3s;
}

.intro-page button:hover{
    transform: scale(1.05);
    background:#ffb347;
}

.intro-page img{
    width:200px;
    margin-top:20px;
    border-radius:20px;
    display:none;
}

.game-container{
    display:none;
    flex-direction:column;
    opacity:0;
}

h2{
    margin-bottom:20px;
}

.progress-bar{
    width:100%;
    height:10px;
    background:rgba(255,255,255,0.3);
    border-radius:20px;
    margin-bottom:20px;
    overflow:hidden;
    transition: background 0.3s;
}

.progress{
    height:100%;
    width:0%;
    background:white;
    transition:0.5s;
}

.options{
    display:flex;
    flex-direction:column;
    gap:12px;
}

button.option-btn{
    padding:12px;
    border:none;
    border-radius:15px;
    font-size:16px;
    cursor:pointer;
    transition:0.3s;
    background:white;
    color:#333;
    font-weight:600;
}

button.option-btn:hover{
    transform:scale(1.05);
    background:#ffd369;
}

.shake{
    animation: shake 0.4s;
}

@keyframes shake{
    0%{transform:translateX(0);}
    25%{transform:translateX(-5px);}
    50%{transform:translateX(5px);}
    75%{transform:translateX(-5px);}
    100%{transform:translateX(0);}
}

.message{
    margin-top:15px;
    font-size:14px;
}

img, video{
    width:100%;
    border-radius:15px;
    margin-top:15px;
}

.dashboard{
    position:fixed;
    top:20px;
    right:20px;
    background:rgba(255,255,255,0.2);
    padding:15px;
    border-radius:15px;
    color:white;
    font-weight:bold;
}

/* PROGRESSIVE IMAGE ON RIGHT SIDE */
#progressiveSorryGuy{
    position:fixed;
    right:20px;
    bottom:50%;
    transform: translateY(50%);
    height:0;
    max-height:150px;
    width:auto;
    transition:height 0.5s ease;
    z-index:10;
}

/* BOUNCE ANIMATION */
@keyframes bounce {
    0% { transform: translateY(50%) scale(1); }
    30% { transform: translateY(45%) scale(1.05); }
    50% { transform: translateY(50%) scale(1); }
    70% { transform: translateY(55%) scale(0.95); }
    100% { transform: translateY(50%) scale(1); }
}
.bounce {
    animation: bounce 0.6s ease;
}

/* RESPONSIVE FOR SMALL DEVICES */
@media (max-width:768px){
    #progressiveSorryGuy{
        right:10px;
        max-height:100px;
    }
    .game-container, .intro-page{
        width:95%;
        padding:20px;
    }
    .intro-page input{
        width:90%;
    }
}
</style>
</head>
<body>

<!-- INTRO PAGE -->
<div class="intro-page" id="introPage">
    <h1>Welcome to Sorry Guy Adventure!</h1>
    <p>Enter your name/nikname to start the game</p>
    <input type="text" id="playerNameInput" placeholder="Your name">
    <br>
    <button id="startGameBtn">Start Game üíñ</button>
    <img id="introGuy" src="sorry-guy.png" alt="Sorry Guy">
</div>

<!-- GAME PAGE -->
<div class="game-container" id="gameContainer">
    <div class="progress-bar">
        <div class="progress" id="progress"></div>
    </div>

    <h2 id="question"></h2>
    <div class="options" id="options"></div>
    <div class="message" id="message"></div>
    <div id="media"></div>
</div>

<!-- DASHBOARD -->
<div class="dashboard" id="dashboard">
    Times Completed: <span id="timesCompleted">0</span>
</div>

<!-- PROGRESSIVE IMAGE -->
<img id="progressiveSorryGuy" src="sorry-guy.png" alt="Sorry Guy">

<audio id="wrongSound">
    <source src="wrong.mp3" type="audio/mpeg">
</audio>

<audio id="correctSound">
    <source src="correct.mp3" type="audio/mpeg">
</audio>

<script>
// ---------- INTRO PAGE ----------
const introPage = document.getElementById('introPage');
const startBtn = document.getElementById('startGameBtn');
const introGuy = document.getElementById('introGuy');
const gameContainer = document.getElementById('gameContainer');
const playerNameInput = document.getElementById('playerNameInput');

let playerName = localStorage.getItem('playerName') || '';
if(playerName) playerNameInput.value = playerName;

startBtn.addEventListener('click', () => {
    const name = playerNameInput.value.trim();
    if(!name) return alert("Please enter your name!");
    playerName = name;
    localStorage.setItem('playerName', playerName);

    introGuy.style.display = 'block';
    setTimeout(() => {
        introPage.style.opacity = 0;
        introPage.style.transform = 'scale(0.95)';
        setTimeout(() => {
            introPage.style.display = 'none';
            gameContainer.style.display = 'flex';
            setTimeout(()=>{gameContainer.style.opacity=1;},50);
            loadStep();
        },500);
    },1500);
});

// ---------- GAME ----------
let step = 0;

const gameFlow = [
    {question:"You gotta go in the", options:["And get","Gym","Angry at all my honesty"], correct:"Gym"},
    {question:"Ehh sorry Ahh", options:["De Paul","Deepal","Nepal"], correct:"Nepal"},
    {question:"I just don‚Äôt want to say that you're", options:["sorry","Really sorry","Apologize"], correct:"sorry"},
    {question:"I know you say that for me", options:["music","slient","sorry"], correct:"slient"},
    {question:"That‚Äôs", options:["sometime","Everytime","Anytime"], correct:"sometime"},
    {question:"Cause I just love you the same", options:["Last chances","Second chances","First chances"], correct:"Second chances"},
    {question:"Is it too", options:["Late","late","lATE","LAate"], correct:"LAate"}
];

// Dashboard completions
let completions = JSON.parse(localStorage.getItem('completions')) || {};
document.getElementById('timesCompleted').innerText = completions[playerName] || 0;

// Progressive Sorry Guy image
const progressiveImg = document.getElementById('progressiveSorryGuy');
function updateSorryGuyImage(){
    const totalSteps = gameFlow.length;
    const stepHeight = 150 / totalSteps;
    progressiveImg.style.height = step * stepHeight + 'px';
}

// Update background gradient per step
function updateBackground(){
    const totalSteps = gameFlow.length;
    const hue = Math.floor((step / totalSteps) * 360);
    document.body.style.background = `linear-gradient(135deg, hsl(${hue},70%,70%), hsl(${(hue+60)%360},70%,70%), hsl(${(hue+120)%360},70%,70%))`;
}

// Update progress bar color
function setProgressBarColor(isCorrect){
    const progressDiv = document.getElementById('progress');
    progressDiv.style.background = isCorrect ? '#4CAF50' : '#FF4C4C';
    setTimeout(()=>{ progressDiv.style.background='white'; }, 500);
}

// Load step
function loadStep(){
    document.getElementById("media").innerHTML = "";
    updateSorryGuyImage();
    updateBackground();

    if(step >= gameFlow.length){
        document.getElementById("question").innerText = `üíñ ${playerName} met Sorry Guy üíñ`;
        document.getElementById("options").innerHTML = "";
        document.getElementById("message").innerText = "";
        document.getElementById("progress").style.width = "100%";

        document.getElementById("media").innerHTML = `
            <video controls autoplay>
                <source src="sorry.mp4" type="video/mp4">
            </video>
            <button id="replayBtn" style="margin-top:15px;padding:12px 25px;font-size:16px;border-radius:10px;background:#ff758c;color:white;border:none;cursor:pointer;">Play Again</button>
            <div id="hearts"></div>
        `;

        completions[playerName] = (completions[playerName] || 0) + 1;
        localStorage.setItem('completions', JSON.stringify(completions));
        document.getElementById('timesCompleted').innerText = completions[playerName];

        progressiveImg.style.height = '150px';
        launchConfetti();

        document.getElementById("replayBtn").addEventListener("click", () => {
            step = 0;
            updateProgress();
            progressiveImg.style.height = '0px';
            loadStep();
        });
        return;
    }

    const current = gameFlow[step];
    document.getElementById("question").innerText = current.question;
    document.getElementById("message").innerText = "";
    const optionsDiv = document.getElementById("options");
    optionsDiv.innerHTML = "";

    current.options.forEach(option=>{
        const btn = document.createElement("button");
        btn.innerText = option;
        btn.classList.add('option-btn');
        btn.onclick = ()=>checkAnswer(option, btn);
        optionsDiv.appendChild(btn);
    });

    updateProgress();
}

// ---------- AUDIO ----------
let wrongAudioTimeout;
function fadeOutAudio(audio, duration = 1000){
    let fadeInterval = 50;
    let steps = duration / fadeInterval;
    let volumeStep = audio.volume / steps;

    let fade = setInterval(() => {
        if(audio.volume - volumeStep > 0){
            audio.volume -= volumeStep;
        } else {
            audio.pause();
            audio.currentTime = 0;
            audio.volume = 1;
            clearInterval(fade);
        }
    }, fadeInterval);
}

// ---------- CHECK ANSWER ----------
function checkAnswer(selected, btn){
    const current = gameFlow[step];
    const wrongAudio = document.getElementById("wrongSound");
    const correctAudio = document.getElementById("correctSound");

    if(wrongAudioTimeout) clearTimeout(wrongAudioTimeout);
    wrongAudio.pause();
    wrongAudio.currentTime = 0;
    wrongAudio.volume = 1;

    if(selected === current.correct){
        correctAudio.currentTime = 0;
        correctAudio.volume = 1;
        correctAudio.play();

        btn.style.background = "#4CAF50";
        btn.style.color = "white";

        step++;
        updateSorryGuyImage();

        // BOUNCE
        progressiveImg.classList.remove('bounce');
        void progressiveImg.offsetWidth;
        progressiveImg.classList.add('bounce');

        setProgressBarColor(true);
        launchConfetti();
        updateBackground();

        setTimeout(()=>{ loadStep(); },500);

    }else{
        btn.classList.add("shake");
        wrongAudio.play();

        document.getElementById("message").innerText =
        "‚ùå Sorry Guy says you can't say sorry!";
        progressiveImg.style.height = '0px';

        document.getElementById("media").innerHTML =
        `<img src="sorry-guy.png" style="width:100%;border-radius:15px;">`;

        wrongAudioTimeout = setTimeout(()=>{
            wrongAudio.pause();
            wrongAudio.currentTime = 0;
        }, 5000);

        setProgressBarColor(false);

        setTimeout(()=>{ restartGame(); },2000);
    }
}

// ---------- RESTART ----------
function restartGame(){
    step = 0;
    updateProgress();
    progressiveImg.style.height = '0px';
    loadStep();
}

// ---------- PROGRESS BAR ----------
function updateProgress(){
    let percent = (step / gameFlow.length) * 100;
    document.getElementById("progress").style.width = percent + "%";
}

// ---------- CONFETTI / HEARTS ----------
function launchConfetti(){
    const hearts = document.getElementById('hearts');
    if(!hearts) return;
    for(let i=0; i<50; i++){
        const heart = document.createElement('div');
        heart.innerText = 'üíñ';
        heart.style.position = 'absolute';
        heart.style.fontSize = Math.random()*30 + 20 + 'px';
        heart.style.left = Math.random()*90 + '%';
        heart.style.top = '-10%';
        heart.style.opacity = 0.8;
        heart.style.transform = `rotate(${Math.random()*360}deg)`;
        hearts.appendChild(heart);

        const duration = Math.random()*3 + 2;
        heart.animate([
            {transform: `translateY(0px) rotate(${Math.random()*360}deg)`},
            {transform: `translateY(600px) rotate(${Math.random()*720}deg)`}
        ], {duration: duration*1000, iterations:1, easing:'ease-out'});

        setTimeout(()=>heart.remove(), duration*1000);
    }
}

</script>
</body>
</html>
